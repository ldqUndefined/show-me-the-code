# 说说immutable

immutable指的是不可变数据，它弥补了javascript里没有不可变数据结构的问题。

javascript中的对象是引用类型，我们可以修改对应引用中对象的值而不导致对应对象引用的变化，可变的好处是节省内存。但是有时也会造成意外且难以预测的副作用。

## 什么是immutable data

immutable data就是指一旦创建，就不能被修改的数据，对immutable对象的任何修改或添加操作都会返回一个新的immutable对象。immutable实现的原理是持久化数据结构，也就是使用旧数据创建新数据时，要保证旧数据同时可用且不变，同时为了避免拷贝的过程中把所有节点都复制一遍带来的性能损耗，immutable使用了结构共享的方式，如果对象树中一个结点发生变化，只修改这个节点和受它影响的父节点，其他结点则进行共享。

## immer



## 为什么不用immutable.js

生成了新的数据结构，需要在原生js和immutable.js对象之间进行转换，且类型编写麻烦。使用immer可以像使用原生JS对象一样操作，方便，且类型和原生js对象一致。

## 为什么React项目需要immutable数据

对于深层对象的值的修改，避免了多层对象解构操作

- 避免由于错误的操作导致该渲染的组件没有发生渲染(即组件的props的引用没有发生变化，不引起重渲染)。
- 避免深拷贝导致的每一层对象的值的引用发生改变而引起组件不必要的渲染。

